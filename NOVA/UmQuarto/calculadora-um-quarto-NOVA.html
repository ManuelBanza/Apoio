<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de Preços</title>
    <script>
        function ajustarIntervaloArea() {
            var partilhado = document.getElementById("partilhado").value;
            var areaInput = document.getElementById("m2");

            if (partilhado === "S") {
                areaInput.min = 12;
                areaInput.max = 20;
                areaInput.placeholder = "Área entre 12m² e 20m²";
            } else {
                areaInput.min = 8;
                areaInput.max = 14;
                areaInput.placeholder = "Área entre 8m² e 14m²";
            }

            // Resetar valor para evitar valores fora do intervalo permitido
            areaInput.value = "";
        }

        function calcularPrecoQuarto() {
            // Teto máximo para todos os concelhos (353€)
            var valorMax = 353;

            // Obter os valores das respostas
            var partilhado = document.getElementById("partilhado").value;
            var concelho = document.getElementById("concelho").value;
            var m2 = parseFloat(document.getElementById("m2").value);
            var isPrivada = document.getElementById("isPrivada").value;
            var conforto = parseFloat(document.getElementById("conforto").value);

            // Pesos dos critérios
            var pesoPartilhado = 0.20; // Redução fixa para quartos partilhados
            var pesoM2 = 0.06;
            var pesoIsPrivada = 0.09;
            var pesoConforto = 0.06;

            // Limites de área
            var areaMin = partilhado === "S" ? 12 : 8; // Mínimo depende se é partilhado ou não
            var areaMax = partilhado === "S" ? 20 : 14; // Máximo depende se é partilhado ou não

            // ** Verificar se está no melhor cenário **
            if (
                partilhado === "N" && // Não é partilhado
                m2 === areaMax && // Área no valor máximo permitido
                isPrivada === "S" && // Casa de banho exclusiva
                conforto === 10 // Conforto no máximo
            ) {
                // Melhor cenário: valor máximo
                document.getElementById("resultadoQuarto").innerHTML =
                    "Recomendamos que o valor a cobrar pelo quarto seja " + valorMax.toFixed(2) + "€ por mês.";
                return valorMax;
            }

            // Aplicar redução para quartos partilhados
            if (partilhado === "S") {
                valorMax *= (1 - pesoPartilhado); // Reduz teto máximo em 20%
            }

            // Calcular contribuição da área (quanto maior, mais caro)
            var scoreM2 = (m2 - areaMin) / (areaMax - areaMin); // Quanto mais próximo de área máxima, maior o score
            scoreM2 = Math.max(0, Math.min(scoreM2, 1)) * pesoM2; // Garantir que está entre 0 e peso máximo

            // Calcular contribuição da casa de banho exclusiva
            var scoreIsPrivada = isPrivada === "S" ? 0 : pesoIsPrivada; // Reduz se não for exclusiva

            // Calcular contribuição do conforto
            var scoreConforto = (10 - conforto) / 10 * pesoConforto; // Quanto menor o conforto, maior a redução

            // Soma total das reduções
            var totalReducoes = scoreM2 + scoreIsPrivada + scoreConforto;

            // Calcular valor final com base nas reduções
            var precoCalculado = valorMax * (1 - totalReducoes);

            // Exibir o resultado final
            document.getElementById("resultadoQuarto").innerHTML =
                "Recomendamos que o valor a cobrar pelo quarto seja " + precoCalculado.toFixed(2) + "€ por mês.";

            return precoCalculado;
        }

        function calcularTotal() {
            var precoQuarto = calcularPrecoQuarto();
            document.getElementById("resultadoTotal").innerHTML =
                "O valor total recomendado é de " + precoQuarto.toFixed(2) + "€ por mês.";
        }
    </script>
    <style>
        .container {
            display: flex;
            justify-content: space-between;
        }
        .calculadora {
            width: 45%;
        }
        #resultadoTotal {
            text-align: center;
            font-size: 1.5em;
            margin-top: 20px;
            font-weight: bold;
        }
        .centered {
            text-align: center;
        }
    </style>
</head>
<body>
    <h1 class="centered">Calculadora de Preço de Quartos</h1>

    <div class="container">
        <!-- Calculadora de Preço de Quarto -->
        <div class="calculadora">
            <h2>Preço do Quarto</h2>

            <form>
                <label for="partilhado">O quarto é partilhado? (S/N):</label><br>
                <select id="partilhado" name="partilhado" required onchange="ajustarIntervaloArea()">
                    <option value="N">Não</option>
                    <option value="S">Sim</option>
                </select><br><br>

                <label for="concelho">Concelho:</label><br>
                <select id="concelho" name="concelho" required>
                    <option value="Alcochete">Alcochete</option>
                    <option value="Almada">Almada</option>
                    <option value="Amadora">Amadora</option>
                    <option value="Barreiro">Barreiro</option>
                    <option value="Cascais">Cascais</option>
                    <option value="Lisboa">Lisboa</option>
                    <option value="Loures">Loures</option>
                    <option value="Mafra">Mafra</option>
                    <option value="Moita">Moita</option>
                    <option value="Montijo">Montijo</option>
                    <option value="Odivelas">Odivelas</option>
                    <option value="Oeiras">Oeiras</option>
                    <option value="Palmela">Palmela</option>
                    <option value="Seixal">Seixal</option>
                    <option value="Sesimbra">Sesimbra</option>
                    <option value="Setúbal">Setúbal</option>
                    <option value="Sintra">Sintra</option>
                    <option value="Vila Franca de Xira">Vila Franca de Xira</option>
                </select><br><br>

                <label for="m2">Área (m²) *</label><br>
                <small>
                    * Quartos single: considerar de 8m² a 14m². Quartos partilhados (2 pessoas máximo): considerar de 12m² a 20m².
                </small><br>
                <input type="number" id="m2" name="m2" min="8" max="14" step="1" placeholder="Área entre 8m² e 14m²" required><br><br>

                <label for="isPrivada">Casa de banho exclusiva? (S/N):</label><br>
                <select id="isPrivada" name="isPrivada" required>
                    <option value="S">Sim</option>
                    <option value="N">Não</option>
                </select><br><br>

                <label for="conforto">Conforto (0 a 10) **:</label><br>
                <small>
                    ** Devem ser considerados aspetos como o conforto térmico, o estado de conservação, a decoração e a exposição solar.
                </small><br>
                <input type="number" id="conforto" name="conforto" min="0" max="10" step="1" required><br><br>

                <button type="button" onclick="calcularTotal()">Calcular Preço</button>
            </form>

            <h3 id="resultadoQuarto"></h3>
        </div>
    </div>

    <!-- Resultado Final -->
    <h2 id="resultadoTotal"></h2>
</body>
</html>
